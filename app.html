<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>SAERP SMT ëŒ€ì‹œë³´ë“œ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <style>
    :root {
      --bg-body: #020617;
      --bg-shell: #020617;
      --bg-sidebar: #020617;
      --bg-card: #020617;
      --border-subtle: #1f2937;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, .12);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
    }
    *{box-sizing:border-box}

    body{
      margin:0;
      min-height:100vh;
      background:radial-gradient(circle at top,#0f172a 0,#020617 45%,#000 100%);
      color:var(--text-main);
      font:14px/1.5 system-ui,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,sans-serif;
      display:flex;
      align-items:stretch;
      justify-content:center;
      padding:16px;
    }

    .stack{
      width:100%;
      max-width:1200px;
      background:var(--bg-shell);
      border-radius:18px;
      border:1px solid rgba(148,163,184,.4);
      box-shadow:0 18px 50px rgba(15,23,42,.9);
      display:flex;
      overflow:hidden;
    }

    /* dummy ì¹´ë“œ (login / signup ìë¦¬ë§Œ ì±„ì›Œì¤Œ) */
    #loginCard,
    #signupCard{
      display:none;
    }

    #appCard{
      flex:1;
      display:flex;
      flex-direction:column;
      min-height:620px;
    }

    .app-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:12px 16px;
      border-bottom:1px solid var(--border-subtle);
      background:linear-gradient(to right,#020617,#020617,#020617);
    }
    .app-title{
      display:flex;
      flex-direction:column;
      gap:2px;
    }
    .app-title h1{
      margin:0;
      font-size:18px;
      letter-spacing:.03em;
    }
    .app-title span{
      font-size:12px;
      color:var(--text-muted);
    }

    .app-actions{
      display:flex;
      align-items:center;
      gap:8px;
    }
    button, .btn{
      font:inherit;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.6);
      background:#020617;
      color:inherit;
      padding:6px 12px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    button:hover, .btn:hover{
      border-color:var(--accent);
      background:var(--accent-soft);
    }
    #themeToggle{
      font-size:12px;
    }

    .app-main{
      display:flex;
      min-height:0;
      flex:1;
    }

    /* ì‚¬ì´ë“œë°” */
    .sidebar{
      width:210px;
      border-right:1px solid var(--border-subtle);
      background:radial-gradient(circle at top left,#020617 0,#020617 40%,#020617 100%);
      padding:14px 10px 12px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .sidebar-section-title{
      font-size:11px;
      text-transform:uppercase;
      color:var(--text-muted);
      letter-spacing:.16em;
      padding:0 6px;
    }
    .menu{
      list-style:none;
      padding:0;
      margin:0;
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .menu-item{
      position:relative;
      border-radius:10px;
      overflow:visible;
    }
    .menu-item > .menu-label{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:6px;
      padding:7px 9px;
      border-radius:10px;
      cursor:pointer;
      color:var(--text-main);
      border:1px solid transparent;
      background:transparent;
    }
    .menu-item > .menu-label span{
      font-size:13px;
    }
    .menu-item > .menu-label small{
      font-size:11px;
      color:var(--text-muted);
    }
    .menu-item:hover > .menu-label{
      background:rgba(15,23,42,.9);
      border-color:rgba(148,163,184,.6);
    }
    .menu-item.open > .menu-label{
      background:rgba(15,23,42,1);
      border-color:var(--accent);
      box-shadow:0 0 0 1px rgba(56,189,248,.25);
    }

    .submenu{
      position:static; /* app.js ëŠ” position ì‹ ê²½ ì•ˆ ì”€ */
      margin-top:4px;
      padding:4px;
      border-radius:10px;
      background:#020617;
      border:1px solid rgba(31,41,55,.9);
      display:none;
    }
    .menu-item.open .submenu{
      display:block;
    }
    .submenu a{
      display:block;
      padding:6px 8px;
      border-radius:8px;
      font-size:13px;
      color:var(--text-main);
      text-decoration:none;
    }
    .submenu a:hover{
      background:rgba(15,23,42,1);
      color:#e5e7eb;
    }

    /* ë³¸ë¬¸ ì˜ì—­ */
    .app-body{
      flex:1;
      padding:10px 14px 14px;
      display:flex;
      flex-direction:column;
      gap:8px;
      overflow:auto;
    }

    #dashboard{
      flex:1;
      border-radius:14px;
      border:1px dashed rgba(55,65,81,.7);
      background:radial-gradient(circle at top,#020617 0,#020617 40%,#020617 100%);
      padding:12px;
      overflow:auto;
    }
    .muted{
      color:var(--text-muted);
      font-size:12px;
    }

    /* í…Œì´ë¸” ê¸°ë³¸ */
    .table-wrap{
      border-radius:12px;
      border:1px solid rgba(55,65,81,.9);
      overflow:hidden;
      background:#020617;
    }
    table.table{
      width:100%;
      border-collapse:collapse;
      font-size:13px;
    }
    table.table thead{
      background:#030712;
    }
    table.table th,
    table.table td{
      padding:6px 8px;
      border-bottom:1px solid rgba(31,41,55,.9);
    }
    table.table tbody tr:hover{
      background:rgba(15,23,42,.9);
    }

    .btn-mini{
      font-size:11px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.7);
      background:#020617;
      color:var(--text-main);
      cursor:pointer;
    }
    .btn-mini:hover{
      border-color:var(--accent);
      background:var(--accent-soft);
    }

    /* ì„ íƒ ëª¨ë‹¬ */
    #selectModal{
      position:fixed;
      inset:0;
      background:rgba(15,23,42,.75);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:9999;
    }
    #selectModal[open]{
      display:flex;
    }
    .select-panel{
      width:520px;
      max-height:80vh;
      background:#020617;
      border-radius:16px;
      border:1px solid rgba(148,163,184,.5);
      box-shadow:0 18px 40px rgba(15,23,42,1);
      display:flex;
      flex-direction:column;
      overflow:hidden;
    }
    .select-header{
      padding:10px 14px;
      border-bottom:1px solid rgba(31,41,55,.9);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    #selectTitle{
      font-size:14px;
      font-weight:600;
    }
    .select-search{
      display:flex;
      align-items:center;
      padding:0 14px 8px;
      gap:6px;
      border-bottom:1px solid rgba(31,41,55,.7);
    }
    .select-search input{
      flex:1;
      padding:5px 8px;
      border-radius:999px;
      border:1px solid rgba(55,65,81,1);
      background:#020617;
      color:var(--text-main);
      font-size:12px;
    }
    .select-body{
      padding:8px 14px 6px;
      flex:1;
      overflow:auto;
    }
    .select-footer{
      border-top:1px solid rgba(31,41,55,.9);
      padding:8px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    #selectEmpty{
      font-size:12px;
      color:var(--text-muted);
      padding:12px 0;
      text-align:center;
    }
    #selectTools{
      display:flex;
      align-items:center;
      gap:6px;
    }
    #selectCount{
      font-size:12px;
      color:var(--text-muted);
    }
    .select-btn-row{
      display:flex;
      gap:6px;
    }

    input[type="checkbox"]{
      accent-color:#38bdf8;
    }
  </style>
</head>
<body>

  <div class="stack">
    <!-- loginCard / signupCard ëŠ” app.js ê°€ ì°¸ì¡°í•˜ë¯€ë¡œ ë¹ˆ ì„¹ì…˜ìœ¼ë¡œ ë‘  -->
    <section id="loginCard"></section>
    <section id="signupCard"></section>

    <!-- ì‹¤ì œ ë©”ì¸ ì•± ì¹´ë“œ -->
    <section id="appCard">
      <header class="app-header">
        <div class="app-title">
          <h1>SAERP SMT ëŒ€ì‹œë³´ë“œ</h1>
          <span>NAS ì„œë²„ì— BOM / ì¢Œí‘œë°ì´í„° / ê²°ê³¼ê°’ì„ ê´€ë¦¬í•˜ëŠ” ì „ìš© í™”ë©´</span>
        </div>
        <div class="app-actions">
          <button id="themeToggle">ğŸŒ™ ë‹¤í¬</button>
          <button id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
      </header>

      <div class="app-main">
        <!-- ì‚¬ì´ë“œë°” -->
        <aside class="sidebar">
          <div class="sidebar-section-title">Automation</div>
          <ul class="menu">
            <li id="menu-automation" class="menu-item">
              <div class="menu-label">
                <span>SMT ë§¤í¬ë¡œ ìë™í™”</span>
                <small>íŒŒì¼ ë“±ë¡ Â· ê²°ê³¼ ì¶œë ¥</small>
              </div>
              <div class="submenu" aria-label="SMT ë§¤í¬ë¡œ ìë™í™” ë©”ë‰´">
                <a href="#" id="mn-bom">BOM ë“±ë¡</a>
                <a href="#" id="mn-coords">ì¢Œí‘œë°ì´í„° ë“±ë¡</a>
                <a href="#" id="mn-extract">ê²°ê³¼ê°’ ì¶”ì¶œ</a>
              </div>
            </li>
          </ul>
        </aside>

        <!-- ë³¸ë¬¸ -->
        <main class="app-body" id="appBody">
          <div id="fileResult" class="muted"></div>
          <div id="coordsContainer" class="muted"></div>

          <div id="dashboard">
            <p class="muted">
              ì¢Œì¸¡ <b>SMT ë§¤í¬ë¡œ ìë™í™”</b> ë©”ë‰´ì—ì„œ<br />
              <b>BOM ë“±ë¡ / ì¢Œí‘œë°ì´í„° ë“±ë¡ / ê²°ê³¼ê°’ ì¶”ì¶œ</b>ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.
            </p>
          </div>
        </main>
      </div>
    </section>
  </div>

  <!-- BOM / ì¢Œí‘œ íŒŒì¼ ì„ íƒìš© ìˆ¨ê¹€ inputë“¤ -->
  <input type="file" id="pickBOMFiles" style="display:none" multiple />
  <input type="file" id="pickBOMEdit" style="display:none" />
  <input type="file" id="pickCoordFiles" style="display:none" multiple />
  <input type="file" id="pickCoordEdit" style="display:none" />

  <!-- ê²°ê³¼ê°’ ì„ íƒ ëª¨ë‹¬ -->
  <div id="selectModal">
    <div class="select-panel" role="dialog" aria-modal="true">
      <div class="select-header">
        <div id="selectTitle">íŒŒì¼ ì„ íƒ</div>
        <button type="button" id="selectClose" class="btn-mini">âœ•</button>
      </div>
      <div class="select-search">
        <input id="selectSearch" type="text" placeholder="íŒŒì¼ëª… ê²€ìƒ‰â€¦" />
      </div>
      <div class="select-body">
        <div id="selectEmpty" class="muted">ë“±ë¡ëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</div>

        <div id="selectTools">
          <button type="button" id="btnSelectAll" class="btn-mini">ì „ì²´ ì„ íƒ</button>
          <button type="button" id="btnSelectNone" class="btn-mini">ì „ì²´ í•´ì œ</button>
          <span id="selectCount" class="muted">0/0ê°œ ì„ íƒ</span>
        </div>

        <div class="table-wrap" style="margin-top:8px;">
          <table class="table" id="selectTable">
            <thead>
              <tr>
                <th style="width:42px;">ì„ íƒ</th>
                <th>íŒŒì¼ëª…</th>
                <th style="width:90px;">í¬ê¸°</th>
                <th style="width:150px;">ë“±ë¡/ìˆ˜ì •ì¼</th>
              </tr>
            </thead>
            <tbody>
              <!-- app.js ì—ì„œ ë Œë”ë§ -->
            </tbody>
          </table>
        </div>
      </div>
      <div class="select-footer">
        <div class="muted">ì„ íƒ í›„ &ldquo;í™•ì¸&rdquo;ì„ ëˆ„ë¥´ë©´ ì ìš©ë©ë‹ˆë‹¤.</div>
        <div class="select-btn-row">
          <button type="button" id="selectCancel" class="btn-mini">ì·¨ì†Œ</button>
          <button type="button" id="selectApply" class="btn-mini">í™•ì¸</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì•± ìŠ¤í¬ë¦½íŠ¸ (NAS ì ˆëŒ€ ê²½ë¡œ ì‚¬ìš©) -->
  <script src="/saerp/xlsx.full.min.js"></script>
  <script src="/saerp/smt_extract.js"></script>
  <script src="/saerp/txt.js"></script>
  <script src="/saerp/app.js"></script>

  <script>
    if (typeof view === 'function') {
      view('app');   // ë°”ë¡œ ë©”ì¸ í™”ë©´
    }

    document.getElementById('mn-bom')?.addEventListener('click', (e)=>{
      e.preventDefault();
      if (typeof showBOMDashboard === 'function') showBOMDashboard();
    });
    document.getElementById('mn-coords')?.addEventListener('click', (e)=>{
      e.preventDefault();
      if (typeof showCoordDashboard === 'function') showCoordDashboard();
    });
    document.getElementById('mn-extract')?.addEventListener('click', (e)=>{
      e.preventDefault();
      if (typeof showExtractDashboard === 'function') showExtractDashboard();
    });
  </script>
</body>
</html>

