<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SMT ì›¹ ë¡œê·¸ì¸/íšŒì›ê°€ì… ë°ëª¨</title>
  <style>
    /* ============ í…Œë§ˆ ============ */
    :root[data-theme="light"]{
      --bg:#0b1220; --card:#0f172a; --fg:#ffffff; --muted:#cbd5e1;
      --accent:#2563eb; --accent-200:#3b82f6; --danger:#ef4444; --border:#334155;
      --nav:#0f1526; --nav-border:#1e293b; --chip:#0f172a; --chip-hover:#162038;
      --shadow:0 10px 30px rgba(0,0,0,.25); --nav-shadow:0 8px 24px rgba(0,0,0,.25);
      --submenu-bg:#0f172a; --submenu-border:#1e293b; --submenu-hover:#162038;
      --table-border:#243042; --overlay:rgba(0,0,0,.55);
    }
    :root[data-theme="dark"]{
      --bg:#0b1220; --card:#0f172a; --fg:#ffffff; --muted:#cbd5e1;
      --accent:#2563eb; --accent-200:#3b82f6; --danger:#ef4444; --border:#334155;
      --nav:#0f1526; --nav-border:#1e293b; --chip:#0f172a; --chip-hover:#162038;
      --shadow:0 10px 30px rgba(0,0,0,.25); --nav-shadow:0 8px 24px rgba(0,0,0,.25);
      --submenu-bg:#0f172a; --submenu-border:#1e293b; --submenu-hover:#162038;
      --table-border:#243042; --overlay:rgba(0,0,0,.55);
    }

    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--fg);
      font:14px/1.5 system-ui,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,sans-serif}
    .wrap{min-height:100dvh;display:grid;place-items:start center;padding:32px}
    .stack{width:100%;max-width:520px;display:flex;flex-direction:column;gap:18px}
    .stack.wide{max-width:1100px;}

    /* ë¡œê³  */
    .ë¡œê³ {display:flex;align-items:center;gap:16px}
    .ë¡œê³  img{height:84px;width:auto;display:block}
    .ë¡œê³  h1{margin:0;font-size:26px;font-weight:800;letter-spacing:-.3px;color:var(--fg)}

    /* ì¹´ë“œ/í¼ */
    .card{background:var(--card);border:1px solid var(--border);
      border-radius:16px;padding:22px 18px;box-shadow:var(--shadow); color:var(--fg)}
    .card h2{margin:6px 4px 16px;font-size:18px;color:var(--fg)}
    .grid{display:grid;gap:10px}
    label{display:grid;gap:6px;color:var(--fg)}
    input[type="text"],input[type="email"],input[type="password"],input[type="tel"]{
      width:100%;padding:12px;border-radius:10px;border:1px solid var(--border);
      background:#0f172a;color:#ffffff;outline:none}
    input::placeholder{color:#9ca3af}
    .chk{display:flex;align-items:center;gap:8px;color:var(--muted)}
    .row{display:flex;gap:10px}.row>*{flex:1}
    .hint{color:var(--muted);font-size:12px}
    .error{color:var(--danger);font-size:12px;margin-top:2px}
    .btn{width:100%;padding:12px 14px;border:1px solid var(--border);border-radius:10px;background:var(--accent);
      color:#fff;font-weight:700;cursor:pointer;transition:filter .2s;white-space:nowrap;line-height:1}
    .btn:hover{filter:brightness(1.05)}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    .link{color:var(--accent);text-decoration:underline;cursor:pointer}
    .footer{color:var(--muted);font-size:12px;text-align:center;margin-top:6px}

    @media (max-width:520px){ .wrap{padding:18px} .ë¡œê³  img{height:70px} }

    /* ìƒë‹¨ ë„¤ë¹„ */
    .app{display:flex;flex-direction:column;gap:10px}
    .topbar{background:var(--nav);border:1px solid var(--nav-border);
      border-radius:12px;padding:8px 10px;display:flex;align-items:center;gap:10px;box-shadow:var(--nav-shadow)}
    .brand{font-weight:800;color:var(--fg); white-space:nowrap;}
    .menu{list-style:none;display:flex;gap:6px;margin:0;padding:0}
    .menu>li{
      position:relative;background:var(--chip);border:1px solid var(--border);
      padding:6px 10px;border-radius:8px;cursor:pointer;user-select:none;font-size:13px;transition:background .2s;
      white-space:nowrap; color:var(--fg);
    }
    .menu>li:hover{background:var(--chip-hover)}
    .submenu{
      position:absolute;left:0;top:100%;margin-top:6px;display:none;min-width:180px;
      background:var(--submenu-bg);border:1px solid var(--submenu-border);border-radius:10px;padding:6px;
      box-shadow:0 4px 16px rgba(0,0,0,.08);z-index:20}
    .submenu a{display:block;padding:8px 10px;border-radius:8px;color:var(--fg);text-decoration:none;font-size:13px;white-space:nowrap}
    .submenu a:hover{background:var(--submenu-hover)}
    .menu>li.open>.submenu{display:block !important}

    .topbar-right{margin-left:auto;display:flex;flex-direction:column;align-items:flex-end;gap:6px}
    .toggle{background:var(--chip);border:1px solid var(--border);color:var(--fg);
      padding:6px 10px;border-radius:8px;cursor:pointer;font-size:13px; white-space:nowrap;}
    .toggle:hover{background:var(--chip-hover)}
    #welcome{line-height:1.2}

    .app-body{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px;min-height:320px;color:var(--fg)}
    .muted{color:var(--muted)}

    /* ëŒ€ì‹œë³´ë“œ ì¹´ë“œ */
    .dash{display:grid;gap:10px;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));margin-top:10px}
    .card-btn{background:var(--chip);border:1px solid var(--border);border-radius:12px;padding:14px;cursor:pointer;text-align:left;transition:background .2s;color:var(--fg);white-space:normal}
    .card-btn:hover{background:var(--chip-hover)}
    .card-title{font-weight:700;margin:0 0 4px;color:var(--fg)}
    .card-desc{color:var(--muted);font-size:12px;margin:0}

    /* í‘œ */
    .table-wrap{border:1px solid var(--table-border);border-radius:8px;overflow:auto;margin-top:14px}
    .table{width:100%;border-collapse:collapse;font-size:13px;color:var(--fg)}
    .table th,.table td{border-bottom:1px solid var(--table-border);padding:8px 10px;text-align:left;white-space:nowrap;color:var(--fg)}
    .table thead th{position:sticky;top:0;background:var(--nav);color:var(--fg)}
    .btn-mini{padding:6px 10px;border-radius:8px;border:1px solid var(--border);background:var(--chip);cursor:pointer;color:var(--fg);white-space:nowrap;line-height:1}
    .btn-mini:hover{background:var(--chip-hover)}
    .btn-ghost{background:transparent;color:var(--fg);border:1px solid var(--border);padding:8px 12px;border-radius:8px;cursor:pointer;white-space:nowrap;line-height:1}

    /* ===== ëª¨ë‹¬ ê³µí†µ ===== */
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:var(--overlay);z-index:100}
    .modal[open]{display:flex}
    .modal-card{
      background:var(--card);color:var(--fg);
      width:min(960px,94vw);
      max-height:92vh;
      border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);
      display:flex;flex-direction:column
    }
    .modal-header{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--border);gap:12px}
    .modal-body{padding:16px;overflow:auto;min-height:420px}
    .modal-body h3{margin:14px 0 6px;font-size:15px}
    .modal-body p,.modal-body li{font-size:13px;color:var(--fg)}
    .modal-footer{display:flex;gap:8px;justify-content:flex-end;padding:12px 16px;border-top:1px solid var(--border)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="stack">
      <!-- ë¡œê³  -->
      <div class="ë¡œê³ ">
        <img src="ë¡œê³ .png" alt="SMT ë¡œê³ " onerror="this.style.display='none'">
        <h1>ERP ì‚¬ë¬´ë¥¼ ìë™í™”</h1>
      </div>

      <!-- ë¡œê·¸ì¸ -->
      <section id="loginCard" class="card">
        <h2>íšŒì› ë¡œê·¸ì¸</h2>
        <form id="loginForm" class="grid" autocomplete="on">
          <label>ì•„ì´ë”” <input id="loginId" type="text" placeholder="ì•„ì´ë””" autocomplete="username" /></label>
          <label>ë¹„ë°€ë²ˆí˜¸ <input id="loginPw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸" autocomplete="current-password" /></label>
          <label class="chk"><input id="autoLogin" type="checkbox" /> ìë™ë¡œê·¸ì¸</label>
          <button id="loginBtn" type="submit" class="btn">ë¡œê·¸ì¸</button>
          <div class="hint">ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠìœ¼ì…¨ë‚˜ìš”? &nbsp;<span class="link" id="toSignup">íšŒì›ê°€ì…</span></div>
          <div id="loginErr" class="error" style="display:none"></div>
        </form>
      </section>

      <!-- íšŒì›ê°€ì… -->
      <section id="signupCard" class="card" style="display:none">
        <h2>íšŒì›ê°€ì…</h2>
        <div class="grid" id="signupForm">
          <label>ì•„ì´ë”” * <input id="suId" type="text" placeholder="4~20ì ì˜ë¬¸/ìˆ«ì" minlength="4" maxlength="20" required></label>
          <label>ì—…ì²´ì´ë¦„ * <input id="suCompany" type="text" placeholder="í•œê¸€ ë˜ëŠ” ì˜ë¬¸" required></label>
          <label>íœ´ëŒ€í° * <input id="suPhone" type="tel" placeholder="íœ´ëŒ€í°" inputmode="numeric" required></label>
          <label>ì´ë©”ì¼ * <input id="suEmail" type="email" placeholder="ì´ë©”ì¼" required></label>
          <div class="row">
            <label>ë¹„ë°€ë²ˆí˜¸ * <input id="suPw" type="password" placeholder="6~20ì" minlength="6" maxlength="20" required></label>
            <label>ë¹„ë°€ë²ˆí˜¸ í™•ì¸ * <input id="suPw2" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸í™•ì¸" minlength="6" maxlength="20" required></label>
          </div>

          <!-- ë™ì˜ + ì „ë¬¸ë³´ê¸°(ëª¨ë‹¬) -->
          <div class="chk">
            <input id="agree" type="checkbox" required>
            <span>ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš© ë™ì˜ (í•„ìˆ˜)</span>
            <button id="openConsent" type="button" class="btn-mini" style="margin-left:auto">ìƒì„¸ ë³´ê¸°</button>
          </div>

          <button id="signupBtn" class="btn" disabled>íšŒì›ê°€ì…</button>
          <div class="hint">ì´ë¯¸ ê³„ì •ì´ ìˆë‚˜ìš”? <span class="link" id="toLogin">ë¡œê·¸ì¸</span></div>
          <div id="signupErr" class="error" style="display:none"></div>
        </div>
      </section>

      <!-- ë¡œê·¸ì¸ í›„ í™”ë©´ -->
      <section id="appCard" class="app" style="display:none">
        <nav class="topbar">
          <div class="brand">ERP Demo</div>
          <ul class="menu">
            <li>ëŒ€ì‹œë³´ë“œ</li>
            <li id="menu-automation">SMT ë§¤í¬ë¡œ ìë™í™”
              <div class="submenu" aria-label="SMT ë§¤í¬ë¡œ ìë™í™” ë©”ë‰´">
                <a href="#" id="mn-bom">BOM ë“±ë¡</a>
                <a href="#" id="mn-coords">ì¢Œí‘œë°ì´í„° ë“±ë¡</a>
                <a href="#" id="mn-extract">ê²°ê³¼ê°’ ì¶”ì¶œ</a>
              </div>
            </li>
          </ul>
          <div class="topbar-right">
            <span id="welcome" class="muted"></span>
            <div style="display:flex;gap:8px;align-items:center">
              <button id="themeToggle" class="toggle" type="button" aria-label="Toggle theme">ğŸŒ™ ë‹¤í¬</button>
              <button id="logoutBtn" class="btn" style="width:auto;padding:6px 10px">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
          </div>
        </nav>

        <div class="app-body" id="appBody">
          <div id="fileResult" class="muted" style="margin-top:12px;"></div>
          <div id="coordsContainer" style="margin-top:12px;"></div>
          <div id="dashboard"></div>
        </div>
      </section>

      <div class="footer">Â© 2025 SMT Demo</div>
    </div>
  </div>

  <!-- ìˆ¨ê¹€ input -->
  <input id="pickFolder"     type="file" webkitdirectory directory hidden>
  <input id="pickBOMFiles"   type="file" accept=".xlsx,.xls,.csv" multiple hidden>
  <input id="pickCoordFiles" type="file" accept=".xlsx,.xls,.csv" multiple hidden>
  <input id="pickBOMEdit"    type="file" accept=".xlsx,.xls,.csv" hidden>
  <input id="pickCoordEdit"  type="file" accept=".xlsx,.xls,.csv" hidden>

  <!-- ê°œì¸ì •ë³´ ë™ì˜ ëª¨ë‹¬ -->
  <div id="consentModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="consentTitle">
    <div class="modal-card">
      <div class="modal-header">
        <strong id="consentTitle">ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš© ë™ì˜ (í•„ìˆ˜)</strong>
        <div style="display:flex;gap:8px">
          <button type="button" class="btn-ghost" onclick="window.print()">ì¸ì‡„</button>
          <button type="button" class="btn-ghost" id="closeConsent">ë‹«ê¸°</button>
        </div>
      </div>
      <div class="modal-body">
        <p style="margin:0 0 8px;color:var(--muted)">ë²„ì „: <b>v1.0 (2025-11-11)</b></p>
        <h3>1. ìˆ˜ì§‘ í•­ëª©</h3>
        <ul><li>í•„ìˆ˜: ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸, ì—…ì²´ëª…, íœ´ëŒ€í°ë²ˆí˜¸, ì´ë©”ì¼, ê°€ì…ì¼ì‹œ</li>
            <li>ìë™ìˆ˜ì§‘: ì ‘ì†ê¸°ë¡, IP, ì¿ í‚¤/LocalStorage, ê¸°ê¸°Â·ë¸Œë¼ìš°ì € ì •ë³´</li></ul>
        <h3>2. ì´ìš© ëª©ì </h3>
        <ul><li>íšŒì› ì‹ë³„, ë¡œê·¸ì¸/ê¶Œí•œê´€ë¦¬</li><li>BOMÂ·ì¢Œí‘œ ê´€ë¦¬ ê¸°ëŠ¥ ì œê³µ</li><li>ë³´ì•ˆÂ·í’ˆì§ˆ ê°œì„ Â·í†µê³„</li></ul>
        <h3>3. ë³´ìœ  ê¸°ê°„</h3>
        <ul><li>íšŒì› íƒˆí‡´ ì‹œ ì§€ì²´ ì—†ì´ íŒŒê¸°</li><li>ë²•ë ¹ ë³´ì¡´ê¸°ê°„ì´ ìˆìœ¼ë©´ ê·¸ì— ë”°ë¦„</li></ul>
        <h3>4. ì œê³µ/ìœ„íƒ/êµ­ì™¸ì´ì „</h3>
        <p>ì›ì¹™ì ìœ¼ë¡œ ì œê³µí•˜ì§€ ì•Šìœ¼ë©°, í•„ìš”í•œ ê²½ìš° ë³„ë„ ê³ ì§€Â·ë™ì˜ë¥¼ ë°›ìŠµë‹ˆë‹¤.</p>
        <h3>5. ê¶Œë¦¬</h3>
        <p>ì—´ëŒÂ·ì •ì •Â·ì‚­ì œÂ·ì²˜ë¦¬ì •ì§€Â·ë™ì˜ì² íšŒ ë° íƒˆí‡´ëŠ” ê³ ê°ì§€ì› ì±„ë„ë¡œ ìš”ì²­ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
        <h3>6. ë™ì˜ ê±°ë¶€ ì‹œ ë¶ˆì´ìµ</h3>
        <p>í•„ìˆ˜ í•­ëª© ë¯¸ë™ì˜ ì‹œ íšŒì›ê°€ì… ë° ì„œë¹„ìŠ¤ ì´ìš©ì´ ì œí•œë©ë‹ˆë‹¤.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn-ghost" id="declineConsent">ì·¨ì†Œ</button>
        <button type="button" class="btn" id="acceptConsent">ë™ì˜</button>
      </div>
    </div>
  </div>

  <!-- ë“±ë¡ í•­ëª© ì„ íƒ ëª¨ë‹¬ (BOM/ì¢Œí‘œ ê³µìš©) -->
  <div id="selectModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="selectTitle" style="display:none">
    <div class="modal-card">
      <div class="modal-header">
        <strong id="selectTitle">ì„ íƒ</strong>
        <div style="display:flex;gap:8px;align-items:center">
          <input id="selectSearch" type="text" placeholder="ì´ë¦„ ê²€ìƒ‰" style="padding:6px 10px;border:1px solid var(--border);border-radius:8px;background:transparent;color:var(--fg)">
          <button type="button" class="btn-ghost" id="selectClose">ë‹«ê¸°</button>
        </div>
      </div>
      <div class="modal-body">
        <div id="selectEmpty" class="muted" style="display:none">ë“±ë¡ëœ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</div>
        <div id="selectTools" style="display:flex;gap:8px;align-items:center;margin-bottom:8px">
          <button type="button" class="btn-mini" id="btnSelectAll">ì „ì²´ì„ íƒ</button>
          <button type="button" class="btn-mini" id="btnSelectNone">ì „ì²´í•´ì œ</button>
          <span id="selectCount" class="muted"></span>
        </div>
        <div class="table-wrap">
          <table class="table" id="selectTable">
            <thead><tr><th style="width:48px">ì„ íƒ</th><th>íŒŒì¼ëª…</th><th style="width:120px">í¬ê¸°</th><th style="width:170px">ë“±ë¡/ìˆ˜ì •</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn-ghost" id="selectCancel">ì·¨ì†Œ</button>
        <button type="button" class="btn" id="selectApply">í™•ì¸</button>
      </div>
    </div>
  </div>

  <script>
    /* ==== í…Œë§ˆ ==== */
    (function themeBoot(){
      const root = document.documentElement;
      const saved = localStorage.getItem('theme');
      const prefersDark = matchMedia('(prefers-color-scheme: dark)').matches;
      const initial = saved || (prefersDark ? 'dark' : 'light');
      root.setAttribute('data-theme', initial);
      updateToggleText(initial);
    })();
    function updateToggleText(theme){
      const btn = document.getElementById('themeToggle');
      if(btn) btn.textContent = theme==='dark' ? 'ğŸŒ ë¼ì´íŠ¸' : 'ğŸŒ™ ë‹¤í¬';
    }
    document.getElementById('themeToggle')?.addEventListener('click', ()=>{
      const root = document.documentElement;
      const cur = root.getAttribute('data-theme') || 'light';
      const next = cur === 'light' ? 'dark' : 'light';
      root.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
      updateToggleText(next);
    });

    /* ==== ë¡œê·¸ì¸/íšŒì›ê°€ì… ==== */
    const ADMIN_ID='admin', ADMIN_PW='1234';
    const store={
      get users(){return JSON.parse(localStorage.getItem('users')||'{}')},
      set users(v){localStorage.setItem('users',JSON.stringify(v))},
      get current(){return localStorage.getItem('currentUser')},
      set current(id){id?localStorage.setItem('currentUser',id):localStorage.removeItem('currentUser')},
      get auto(){return localStorage.getItem('autoLogin')==='true'},
      set auto(v){localStorage.setItem('autoLogin',v?'true':'false')}
    };
    const $=s=>document.querySelector(s);
    const stackEl = document.querySelector('.stack');

    const view=name=>{
      $("#loginCard").style.display=(name==='login')?'':'none';
      $("#signupCard").style.display=(name==='signup')?'':'none';
      $("#appCard").style.display=(name==='app')?'':'none';
      if(stackEl){ if(name==='app') stackEl.classList.add('wide'); else stackEl.classList.remove('wide'); }
    };

    (function init(){
      const id=store.current;
      if(store.auto&&id){ if(id===ADMIN_ID||store.users[id]){enterApp(id);return} }
      view('login');
    })();

    function handleLogin(){
      const id=$("#loginId").value.trim(), pw=$("#loginPw").value, users=store.users;
      const err=$("#loginErr"); err.style.display='none';
      if(!id||!pw) return showErr(err,"ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
      if(id===ADMIN_ID && pw===ADMIN_PW){ store.current=ADMIN_ID; store.auto=$("#autoLogin").checked; enterApp(ADMIN_ID); return; }
      if(!users[id]) return showErr(err,"ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤.");
      if(users[id].pw!==pw) return showErr(err,"ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
      store.current=id; store.auto=$("#autoLogin").checked; enterApp(id);
    }
    $("#loginBtn")?.addEventListener('click',e=>{e.preventDefault();handleLogin()});
    $("#loginForm")?.addEventListener('submit',e=>{e.preventDefault();handleLogin()});
    function enterApp(id){ $("#welcome").textContent=`${id}ë‹˜ ì ‘ì†ë¨`; view('app'); }
    $("#logoutBtn")?.addEventListener('click',()=>{ store.current=null; store.auto=false;
      $("#loginId").value=$("#loginPw").value=""; $("#autoLogin").checked=false; view('login'); });

    // íšŒì›ê°€ì… í™œì„±í™”
    const req=["#suId","#suCompany","#suPhone","#suEmail","#suPw","#suPw2"];
    function q(sel){ return document.querySelector(sel); }
    function valOK(sel){ const el=q(sel); return !!(el && el.value.trim().length>0); }
    function enableIfValid(){
      const filled = req.every(valOK);
      const pwOK   = q('#suPw') && q('#suPw2') && (q('#suPw').value === q('#suPw2').value);
      const agreed = q('#agree') ? q('#agree').checked : false;
      const btn = q('#signupBtn'); if(btn) btn.disabled = !(filled && pwOK && agreed);
    }
    [...req, '#suPw', '#suPw2', '#agree'].forEach(sel=>{
      q(sel)?.addEventListener('input', enableIfValid);
      q(sel)?.addEventListener('change', enableIfValid);
    });

    $("#signupBtn")?.addEventListener('click',()=>{
      const err=$("#signupErr"); err.style.display='none';
      const id=$("#suId").value.trim(), users=store.users;
      if(!q('#agree')?.checked) return showErr(err,"ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš©ì— ë™ì˜í•´ ì£¼ì„¸ìš”.");
      if(id.toLowerCase()===ADMIN_ID) return showErr(err,"'admin'ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤.");
      if(!/^[A-Za-z0-9_\-]{4,20}$/.test(id)) return showErr(err,"ì•„ì´ë””ëŠ” 4~20ì ì˜ë¬¸/ìˆ«ì/[-,_]ë§Œ í—ˆìš©í•©ë‹ˆë‹¤.");
      if(users[id]) return showErr(err,"ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì•„ì´ë””ì…ë‹ˆë‹¤.");
      if($("#suPw").value !== $("#suPw2").value) return showErr(err,"ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
      users[id]={id,company:$("#suCompany").value.trim(),phone:$("#suPhone").value.trim(),email:$("#suEmail").value.trim(),pw:$("#suPw").value,createdAt:new Date().toISOString()};
      store.users=users; store.current=id; store.auto=false; enterApp(id);
    });
    function showErr(n,m){ if(!n) return; n.textContent=m; n.style.display='block'; }
    $("#toSignup")?.addEventListener('click',()=>view('signup'));
    $("#toLogin")?.addEventListener('click',()=>view('login'));

    // ê°œì¸ì •ë³´ ë™ì˜ ëª¨ë‹¬
    const consentModal = document.getElementById('consentModal');
    document.getElementById('openConsent')?.addEventListener('click', ()=>consentModal.setAttribute('open',''));
    document.getElementById('closeConsent')?.addEventListener('click', ()=>consentModal.removeAttribute('open'));
    document.getElementById('declineConsent')?.addEventListener('click', ()=>{
      const agree=document.getElementById('agree'); if(agree) agree.checked=false; enableIfValid(); consentModal.removeAttribute('open');
    });
    document.getElementById('acceptConsent')?.addEventListener('click', ()=>{
      const agree=document.getElementById('agree'); if(agree) agree.checked=true; enableIfValid(); consentModal.removeAttribute('open');
    });
    consentModal?.addEventListener('click', e=>{ if(e.target===consentModal) consentModal.removeAttribute('open'); });

    /* ==== ì„œë¸Œë©”ë‰´ ìœ ì§€ ==== */
    (function keepSubmenuUntilOutsideClick(){
      const menuItem=document.getElementById('menu-automation'); if(!menuItem) return;
      const submenu=menuItem.querySelector('.submenu');
      const open=()=>menuItem.classList.add('open');
      const close=()=>menuItem.classList.remove('open');
      menuItem.addEventListener('mouseenter',open); submenu?.addEventListener('mouseenter',open);
      menuItem.addEventListener('click',(e)=>{open();e.stopPropagation()});
      submenu?.addEventListener('click',e=>e.stopPropagation());
      document.addEventListener('click',e=>{ if(!menuItem.contains(e.target)) close(); },true);
      document.addEventListener('keydown',e=>{ if(e.key==='Escape') close(); });
      document.addEventListener('touchstart',e=>{ if(!menuItem.contains(e.target)) close(); },{capture:true,passive:true});
    })();

    /* ==== ê³µí†µ ìœ í‹¸ ==== */
    async function pickTargetDirectory(){
      if (!('showDirectoryPicker' in window)) return null;
      try{ return await window.showDirectoryPicker({id:'smt-save',mode:'readwrite',startIn:'documents'}); }
      catch(e){ return null; }
    }
    async function ensureSubfolder(parent,name){ try{ return await parent.getDirectoryHandle(name,{create:true}); }catch(e){ return parent; } }
    async function saveFileToDirectory(dirHandle,file,subFolder){
      try{
        if(subFolder) dirHandle = await ensureSubfolder(dirHandle, subFolder);
        const fh = await dirHandle.getFileHandle(file.name,{create:true});
        const w = await fh.createWritable(); await w.write(await file.arrayBuffer()); await w.close(); return true;
      }catch(e){ console.error(e); return false; }
    }
    function forceDownload(file,prefix){
      const url=URL.createObjectURL(file); const a=document.createElement('a');
      a.href=url; a.download=`${prefix?prefix+'-':''}${file.name}`;
      document.body.appendChild(a); a.click();
      setTimeout(()=>{document.body.removeChild(a);URL.revokeObjectURL(url);},0);
    }

    /* ==== BOM ë¼ì´ë¸ŒëŸ¬ë¦¬ ==== */
    const bomLib = {
      _key:'bomLibrary',
      all(){ return JSON.parse(localStorage.getItem(this._key)||'[]'); },
      save(list){ localStorage.setItem(this._key, JSON.stringify(list)); },
      add(files){ const list=this.all(); const now=new Date().toISOString();
        for(const f of files){ list.push({ id:crypto.randomUUID(), name:f.name, size:f.size, type:f.type, savedAt:now, updatedAt:null }); }
        this.save(list);
      },
      update(id, file){ const list=this.all(); const i=list.findIndex(x=>x.id===id); if(i>-1){ list[i]={...list[i], name:file.name, size:file.size, type:file.type, updatedAt:new Date().toISOString()}; this.save(list); } },
      remove(id){ const list=this.all().filter(x=>x.id!==id); this.save(list); }
    };
    window.bomLib = bomLib; // ì „ì—­ alias

    function showBOMDashboard(){
      setBodyHTML(`
        <h2 style="margin:0 0 10px 0">BOM ëŒ€ì‹œë³´ë“œ</h2>
        <div class="dash">
          <button class="card-btn" id="btnBOMReg">
            <p class="card-title">BOM ë“±ë¡</p>
            <p class="card-desc">ì—‘ì…€/CSV íŒŒì¼ì„ ì„ íƒí•´ ì €ì¥</p>
          </button>
          <button class="card-btn" id="btnHome">
            <p class="card-title">ëŒ€ì‹œë³´ë“œ</p>
            <p class="card-desc">í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</p>
          </button>
        </div>

        <div id="bomLog" class="muted" style="margin-top:12px;"></div>

        <div class="table-wrap">
          <table class="table" id="bomTable">
            <thead><tr><th>íŒŒì¼ëª…</th><th>í¬ê¸°</th><th>ë“±ë¡ì¼</th><th>ìˆ˜ì •ì¼</th><th>ì‘ì—…</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      `);

      document.getElementById('bomLog').textContent = 'BOM ë“±ë¡ ì–‘ì‹ì— ë§ì¶°ì„œ ë“±ë¡ ë¶€íƒë“œë¦¬ê² ìŠµë‹ˆë‹¤!';

      document.getElementById('btnBOMReg').addEventListener('click',()=>{
        document.getElementById('pickBOMFiles').value=''; document.getElementById('pickBOMFiles').click();
      });
      document.getElementById('btnHome').addEventListener('click',()=>{ setBodyHTML(''); });

      renderBOMList();
    }

    function renderBOMList(){
      const tbody = document.querySelector('#bomTable tbody');
      if(!tbody) return;
      const list = bomLib.all();
      const fmt = n => (n/1024).toFixed(1)+' KB';
      const esc = s => s.replace(/[&<>"]/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m]));
      tbody.innerHTML = list.map(r=>`
        <tr data-id="${r.id}">
          <td>${esc(r.name)}</td>
          <td>${fmt(r.size)}</td>
          <td>${r.savedAt ? r.savedAt.replace('T',' ').slice(0,19) : '-'}</td>
          <td>${r.updatedAt ? r.updatedAt.replace('T',' ').slice(0,19) : '-'}</td>
          <td>
            <button class="btn-mini act-edit">ìˆ˜ì •</button>
            <button class="btn-mini act-del">ì‚­ì œ</button>
          </td>
        </tr>
      `).join('') || `<tr><td colspan="5" class="muted">ì €ì¥ëœ BOM íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;

      // ìˆ˜ì •
      tbody.querySelectorAll('.act-edit').forEach(btn=>{
        btn.addEventListener('click',()=>{
          const id = btn.closest('tr').dataset.id;
          const pick = document.getElementById('pickBOMEdit');
          pick.onchange = e=>{
            const f = e.target.files?.[0]; if(!f) return;
            bomLib.update(id, f);
            renderBOMList();
            logBom(`âœï¸ ìˆ˜ì • ì™„ë£Œ: ${f.name}`);
            pick.value='';
          };
          pick.value=''; pick.click();
        });
      });

      // ì‚­ì œ
      tbody.querySelectorAll('.act-del').forEach(btn=>{
        btn.addEventListener('click',()=>{
          const id = btn.closest('tr').dataset.id;
          bomLib.remove(id);
          renderBOMList();
        });
      });
    }
    function logBom(msg){ const log=document.getElementById('bomLog'); if(log) log.innerHTML=msg; }

    /* ==== ì¢Œí‘œë°ì´í„° ë¼ì´ë¸ŒëŸ¬ë¦¬ ==== */
    const coordLib = {
      _key:'coordLibrary',
      all(){ return JSON.parse(localStorage.getItem(this._key)||'[]'); },
      save(list){ localStorage.setItem(this._key, JSON.stringify(list)); },
      add(files){ const list=this.all(); const now=new Date().toISOString();
        for(const f of files){ list.push({ id:crypto.randomUUID(), name:f.name, size:f.size, type:f.type, savedAt:now, updatedAt:null }); }
        this.save(list);
      },
      update(id, file){ const list=this.all(); const i=list.findIndex(x=>x.id===id); if(i>-1){ list[i]={...list[i], name:file.name, size:file.size, type:file.type, updatedAt:new Date().toISOString()}; this.save(list); } },
      remove(id){ const list=this.all().filter(x=>x.id!==id); this.save(list); }
    };
    window.coordLib = coordLib; // ì „ì—­ alias

    function showCoordDashboard(){
      setBodyHTML(`
        <h2 style="margin:0 0 10px 0">ì¢Œí‘œë°ì´í„° ëŒ€ì‹œë³´ë“œ</h2>
        <div class="dash">
          <button class="card-btn" id="btnCoordReg">
            <p class="card-title">ì¢Œí‘œë°ì´í„° ë“±ë¡</p>
            <p class="card-desc">ì—‘ì…€/CSV íŒŒì¼ì„ ì„ íƒí•´ ì €ì¥</p>
          </button>
          <button class="card-btn" id="btnHome2">
            <p class="card-title">ëŒ€ì‹œë³´ë“œ</p>
            <p class="card-desc">í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</p>
          </button>
        </div>

        <div id="coordLog" class="muted" style="margin-top:10px;"></div>

        <div class="table-wrap">
          <table class="table" id="coordTable">
            <thead><tr><th>íŒŒì¼ëª…</th><th>í¬ê¸°</th><th>ë“±ë¡ì¼</th><th>ìˆ˜ì •ì¼</th><th>ì‘ì—…</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      `);
      document.getElementById('btnCoordReg').addEventListener('click',()=>{
        document.getElementById('pickCoordFiles').value=''; document.getElementById('pickCoordFiles').click();
      });
      document.getElementById('btnHome2').addEventListener('click',()=>{ setBodyHTML(''); });

      renderCoordList();
    }

    function renderCoordList(){
      const tbody = document.querySelector('#coordTable tbody');
      if(!tbody) return;
      const list = coordLib.all();
      const fmt = n => (n/1024).toFixed(1)+' KB';
      const esc = s => s.replace(/[&<>"]/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m]));
      tbody.innerHTML = list.map(r=>`
        <tr data-id="${r.id}">
          <td>${esc(r.name)}</td>
          <td>${fmt(r.size)}</td>
          <td>${r.savedAt ? r.savedAt.replace('T',' ').slice(0,19) : '-'}</td>
          <td>${r.updatedAt ? r.updatedAt.replace('T',' ').slice(0,19) : '-'}</td>
          <td>
            <button class="btn-mini act-edit2">ìˆ˜ì •</button>
            <button class="btn-mini act-del2">ì‚­ì œ</button>
          </td>
        </tr>
      `).join('') || `<tr><td colspan="5" class="muted">ì €ì¥ëœ ì¢Œí‘œë°ì´í„° íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;

      // ìˆ˜ì •
      tbody.querySelectorAll('.act-edit2').forEach(btn=>{
        btn.addEventListener('click',()=>{
          const id = btn.closest('tr').dataset.id;
          const pick = document.getElementById('pickCoordEdit');
          pick.onchange = e=>{
            const f = e.target.files?.[0]; if(!f) return;
            coordLib.update(id, f);
            renderCoordList();
            pick.value='';
          };
          pick.value=''; pick.click();
        });
      });

      // ì‚­ì œ
      tbody.querySelectorAll('.act-del2').forEach(btn=>{
        btn.addEventListener('click',()=>{
          const id = btn.closest('tr').dataset.id;
          coordLib.remove(id);
          renderCoordList();
        });
      });
    }
    function logCoord(msg){ const log=document.getElementById('coordLog'); if(log) log.innerHTML=msg; }

    /* ==== íŒŒì¼ ì„ íƒ í•¸ë“¤ëŸ¬ ==== */
    document.getElementById('pickBOMFiles')?.addEventListener('change', async e=>{
      const files = Array.from(e.target.files||[]); if(!files.length) return;
      logBom(`ğŸ“„ ì„ íƒ: ${files.map(f=>f.name).slice(0,5).join(', ')}${files.length>5?` ì™¸ ${files.length-5}ê°œ`:''}<br>ì €ì¥ í´ë”ë¥¼ ì„ íƒí•˜ì„¸ìš”â€¦`);
      let dirHandle = await pickTargetDirectory();
      if(dirHandle){
        let ok=0; for(const f of files){ if(await saveFileToDirectory(dirHandle,f,'BOM')) ok++; }
        logBom(`âœ… ì €ì¥ ì™„ë£Œ: ${ok}/${files.length}ê°œ (ê²½ë¡œ: ì„ íƒ í´ë”/BOM)`);
      }else{
        files.forEach(f=>forceDownload(f,'BOM'));
        logBom(`â¬‡ï¸ ë¸Œë¼ìš°ì € ë‹¤ìš´ë¡œë“œë¡œ ì €ì¥í–ˆìŠµë‹ˆë‹¤.`);
      }
      bomLib.add(files);
      renderBOMList();
    });

    document.getElementById('pickCoordFiles')?.addEventListener('change', async e=>{
      const files = Array.from(e.target.files||[]); if(!files.length) return;
      let dirHandle = await pickTargetDirectory();
      if(dirHandle){
        let ok=0; for(const f of files){ if(await saveFileToDirectory(dirHandle,f,'COORDS')) ok++; }
        logCoord(`âœ… ì €ì¥ ì™„ë£Œ: ${ok}/${files.length}ê°œ (ê²½ë¡œ: ì„ íƒ í´ë”/COORDS)`);
      }else{
        files.forEach(f=>forceDownload(f,'COORD'));
        logCoord(`â¬‡ï¸ ë¸Œë¼ìš°ì € ë‹¤ìš´ë¡œë“œë¡œ ì €ì¥í–ˆìŠµë‹ˆë‹¤.`);
      }
      coordLib.add(files);
      renderCoordList();
    });

    /* ==== ë·° ìœ í‹¸ ==== */
    const dashboard=document.getElementById('dashboard');
    function clearBodyLog(){ const fr=$("#fileResult"); if(fr) fr.innerHTML=''; const cc=$("#coordsContainer"); if(cc) cc.innerHTML=''; }
    function setBodyHTML(html){ const body=$("#appBody"); clearBodyLog(); dashboard.innerHTML=html||''; body.scrollTo({top:0,behavior:'smooth'}) }

    /* ==== ê²°ê³¼ê°’ ì¶”ì¶œ ==== */
    const EXTRACT_KEY = 'extractSelection';
    const extractState = (()=>{
      try{ return JSON.parse(localStorage.getItem(EXTRACT_KEY)||'{}'); }
      catch{ return {}; }
    })();
    if(!extractState.bomIds) extractState.bomIds = [];
    if(!extractState.coordIds) extractState.coordIds = [];
    function saveExtractState(){ localStorage.setItem(EXTRACT_KEY, JSON.stringify(extractState)); }

    function showExtractDashboard(){
      const bomCnt = (extractState.bomIds||[]).length;
      const coordCnt = (extractState.coordIds||[]).length;

      setBodyHTML(`
        <h2 style="margin:0 0 10px 0">ê²°ê³¼ê°’ ì¶”ì¶œ</h2>
        <div class="dash">
          <button class="card-btn" id="btnPickBOM">
            <p class="card-title">BOM ì„ íƒ</p>
            <p class="card-desc">ë“±ë¡ëœ BOM ì¤‘ì—ì„œ ì„ íƒ (${bomCnt}ê°œ ì„ íƒë¨)</p>
          </button>
          <button class="card-btn" id="btnPickCoord">
            <p class="card-title">ì¢Œí‘œë°ì´í„° ì„ íƒ</p>
            <p class="card-desc">ë“±ë¡ëœ ì¢Œí‘œë°ì´í„° ì¤‘ì—ì„œ ì„ íƒ (${coordCnt}ê°œ ì„ íƒë¨)</p>
          </button>
          <button class="card-btn" id="btnHome3">
            <p class="card-title">ëŒ€ì‹œë³´ë“œ</p>
            <p class="card-desc">í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</p>
          </button>
        </div>

        <div class="table-wrap" style="margin-top:12px">
          <table class="table" id="extractTable">
            <thead><tr><th>êµ¬ë¶„</th><th>íŒŒì¼ëª…</th><th>í¬ê¸°</th><th>ë“±ë¡/ìˆ˜ì •ì¼</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      `);

      renderExtractSelectedTable();

      document.getElementById('btnPickBOM')?.addEventListener('click', ()=> openSelectModal('bom'));
      document.getElementById('btnPickCoord')?.addEventListener('click', ()=> openSelectModal('coord'));
      document.getElementById('btnHome3')?.addEventListener('click', ()=> setBodyHTML(''));
    }

    function renderExtractSelectedTable(){
      const tbody = document.querySelector('#extractTable tbody'); if(!tbody) return;
      const listB = (window.bomLib.all()||[]).filter(r=>extractState.bomIds.includes(r.id)).map(x=>({type:'BOM',...x}));
      const listC = (window.coordLib.all()||[]).filter(r=>extractState.coordIds.includes(r.id)).map(x=>({type:'COORD',...x}));
      const rows = [...listB, ...listC];
      const fmt = n => (n/1024).toFixed(1)+' KB';
      const dt = r => r.updatedAt ? r.updatedAt.replace('T',' ').slice(0,19)
                                  : (r.savedAt? r.savedAt.replace('T',' ').slice(0,19) : '-');
      const esc = s => String(s).replace(/[&<>"]/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m]));
      tbody.innerHTML = rows.length ? rows.map(r=>`
        <tr>
          <td>${r.type}</td>
          <td>${esc(r.name)}</td>
          <td>${fmt(r.size)}</td>
          <td>${dt(r)}</td>
        </tr>
      `).join('') : `<tr><td colspan="4" class="muted">ì„ íƒëœ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤. ìƒë‹¨ì—ì„œ ì„ íƒí•´ ì£¼ì„¸ìš”.</td></tr>`;
    }

    /* === ì„ íƒ ëª¨ë‹¬ === */
    const selectModal=document.getElementById('selectModal');
    const selectTitle=document.getElementById('selectTitle');
    const selectSearch=document.getElementById('selectSearch');
    const selectClose=document.getElementById('selectClose');
    const selectCancel=document.getElementById('selectCancel');
    const selectApply=document.getElementById('selectApply');
    const selectEmpty=document.getElementById('selectEmpty');
    const selectTools=document.getElementById('selectTools');
    const selectCount=document.getElementById('selectCount');
    const btnSelectAll=document.getElementById('btnSelectAll');
    const btnSelectNone=document.getElementById('btnSelectNone');
    const selectTable=document.getElementById('selectTable');

    function getLibAll(type){ return type==='bom' ? window.bomLib.all() : window.coordLib.all(); }

    let currentSelectType=null, currentRows=[], checkboxCache=new Map();

    function openSelectModal(type){
      currentSelectType = type;
      selectTitle.textContent = (type==='bom') ? 'BOM ì„ íƒ' : 'ì¢Œí‘œë°ì´í„° ì„ íƒ';

      const raw = getLibAll(type);
      const selectedIds = (type==='bom') ? (extractState.bomIds||[]) : (extractState.coordIds||[]);
      checkboxCache = new Map(raw.map(r=>[r.id, selectedIds.includes(r.id)]));

      renderSelectTable(raw);

      selectModal.setAttribute('open','');
      selectModal.style.display='flex';
    }
    function closeSelectModal(){ selectModal.removeAttribute('open'); selectModal.style.display='none'; }
    window.openSelectModal = openSelectModal; // ë©”ë‰´ í•¸ë“¤ëŸ¬ì—ì„œ í˜¸ì¶œ

    selectClose.addEventListener('click', closeSelectModal);
    selectCancel.addEventListener('click', closeSelectModal);
    selectModal.addEventListener('click', e=>{ if(e.target===selectModal) closeSelectModal(); });
    document.addEventListener('keydown', e=>{ if(e.key==='Escape' && selectModal.hasAttribute('open')) closeSelectModal(); });

    selectApply.addEventListener('click', ()=>{
      const ids = [...checkboxCache.entries()].filter(([id,v])=>v).map(([id])=>id);
      if(currentSelectType==='bom') extractState.bomIds = ids;
      else extractState.coordIds = ids;
      saveExtractState();
      closeSelectModal();
      showExtractDashboard();
    });

    btnSelectAll.addEventListener('click', ()=>{
      currentRows.forEach(r=>checkboxCache.set(r.id, true));
      syncCheckboxesFromCache(); updateSelectCount();
    });
    btnSelectNone.addEventListener('click', ()=>{
      currentRows.forEach(r=>checkboxCache.set(r.id, false));
      syncCheckboxesFromCache(); updateSelectCount();
    });
    selectSearch.addEventListener('input', ()=>{
      const term = (selectSearch.value||'').trim().toLowerCase();
      const src = getLibAll(currentSelectType);
      const filtered = term ? src.filter(r=> (r.name||'').toLowerCase().includes(term) ) : src;
      renderSelectTable(filtered);
    });

    function renderSelectTable(list){
      currentRows = list.slice();
      const tbody = selectTable.querySelector('tbody');
      const fmt = n => (n/1024).toFixed(1)+' KB';
      const dt = r => r.updatedAt ? r.updatedAt.replace('T',' ').slice(0,19)
                                  : (r.savedAt? r.savedAt.replace('T',' ').slice(0,19) : '-');
      const esc = s => String(s).replace(/[&<>"]/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m]));

      selectEmpty.style.display = list.length? 'none':'block';
      selectTools.style.display = list.length? 'flex':'none';

      tbody.innerHTML = list.map(r=>{
        const checked = !!checkboxCache.get(r.id);
        return `
          <tr data-id="${r.id}">
            <td><input type="checkbox" class="selRow" ${checked?'checked':''}></td>
            <td>${esc(r.name)}</td>
            <td>${fmt(r.size)}</td>
            <td>${dt(r)}</td>
          </tr>
        `;
      }).join('');

      tbody.querySelectorAll('.selRow').forEach((cb, idx)=>{
        const id = list[idx].id;
        cb.addEventListener('change', ()=>{ checkboxCache.set(id, cb.checked); updateSelectCount(); });
      });

      updateSelectCount();
    }
    function syncCheckboxesFromCache(){
      const trs = [...selectTable.querySelectorAll('tbody tr')];
      trs.forEach(tr=>{
        const id = tr.getAttribute('data-id');
        const cb = tr.querySelector('.selRow');
        if(cb && checkboxCache.has(id)) cb.checked = !!checkboxCache.get(id);
      });
    }
    function updateSelectCount(){
      const total = currentRows.length;
      const checked = [...checkboxCache.entries()].filter(([id,v])=> v && currentRows.find(r=>r.id===id)).length;
      selectCount.textContent = `${checked}/${total}ê°œ ì„ íƒ`;
    }

    // ë©”ë‰´ ì—°ê²°
    document.getElementById('mn-bom')?.addEventListener('click',e=>{e.preventDefault();showBOMDashboard()});
    document.getElementById('mn-coords')?.addEventListener('click',e=>{e.preventDefault();showCoordDashboard()});
    document.getElementById('mn-extract')?.addEventListener('click',e=>{e.preventDefault();showExtractDashboard()});
  </script>
</body>
</html>
